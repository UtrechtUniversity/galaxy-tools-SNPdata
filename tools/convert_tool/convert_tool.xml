<tool id="convert_tool" name="Convert Tool" version="0.1.0+galaxy0" python_template_version="3.5" profile="21.05">
    <requirements>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[

    #if $inputplatform == "embark" or $inputplatform == "lupa170" or $inputplatform == "mdd" or $inputplatform == "affymetrix"
        bash $__tool_directory__/convert.sh -i $inputbim -e $inputbed -a $inputfam -p $inputplatform -o $filename_output -x $__tool_directory__ &&
        rm $__tool_directory__/'$filename_output'_ExcludedSNPs.list &&
    #elif $inputplatform == "neogen220" or $inputplatform == "neogen170"
        bash $__tool_directory__/convert.sh -n $inputneogen -p $inputplatform -o $filename_output -x $__tool_directory__ &&
    #elif $inputplatform == "vcf3" or $inputplatform == "vcf4"
        bash $__tool_directory__/convert.sh -v $inputvcf -p $inputplatform -o $filename_output -x $__tool_directory__ &&
        rm '$inputvcf'.tbi &&
    #end if
   
    mv '$filename_output'.bed $outputbed &&
    mv '$filename_output'.bim $outputbim &&
    mv '$filename_output'.fam $outputfam

    ]]></command>

    <inputs>

        <conditional name="inputs_platform">
            <param name="inputplatform" type="select" label="Specify the platform">
                <option value="embark">embark</option>
                <option value="lupa170">lupa170</option>
                <option value="neogen170">neogen170</option>
                <option value="neogen220">neogen220</option>
                <option value="vcf3">vcf3</option>
                <option value="vcf4">vcf4</option>
                <option value="affymetrix">affymetrix</option>
                <option value="mdd">mdd</option>
            </param>

            <when value="embark">
                <param name="inputbed" type="data" format="data" label="Select the .bed file"/>
                <param name="inputbim" type="data" format="data" label="Select the .bim file"/>
                <param name="inputfam" type="data" format="data" label="Select the .fam file"/>
            </when>
            <when value="lupa170">
                <param name="inputbed" type="data" format="data" label="Select the .bed file"/>
                <param name="inputbim" type="data" format="data" label="Select the .bim file"/>
                <param name="inputfam" type="data" format="data" label="Select the .fam file"/>
            </when>
            <when value="mdd">
                <param name="inputbed" type="data" format="data" label="Select the .bed file"/>
                <param name="inputbim" type="data" format="data" label="Select the .bim file"/>
                <param name="inputfam" type="data" format="data" label="Select the .fam file"/>
            </when>
            <when value="neogen170">
                <param name="inputneogen" type="data" format="data" label="Select the final report file of Neogen170K"/>
            </when>
            <when value="neogen220">
                <param name="inputneogen" type="data" format="data" label="Select the final report file of Neogen220K"/>
            </when>
            <when value="vcf3">
                <param name="inputvcf" type="data" format="data" label="Select the VCF3 (WGS) file (zip)"/>
            </when>
            <when value="vcf4">
                <param name="inputvcf" type="data" format="data" label="Select the VCF4 (WGS) file (zip)"/>
            </when>
            <when value="affymetrix">
                <param name="inputbed" type="data" format="data" label="Select the .bed file"/>
                <param name="inputbim" type="data" format="data" label="Select the .bim file"/>
                <param name="inputfam" type="data" format="data" label="Select the .fam file"/>
            </when>
        </conditional>

        <param name="filename_output" type="text" format="text" label="Prefix for the output file" optional="false"/>

    </inputs>
    <outputs>
            <data name="outputhh" format="data" label="${filename_output}.hh from Plink">
                <filter>(inputs_platform['inputplatform'] == "embark")</filter>
            </data>
            <data name="outputbed" format="binary" label="${filename_output}.bed from convert_tool"/>
            <data name="outputbim" format="tabular" label="${filename_output}.bim from convert_tool"/>
            <data name="outputfam" format="txt" label="${filename_output}.fam from convert_tool"/>
    </outputs>
    <tests>
        <test>
            <param name="input1" value="2.fastq"/>
            <output name="output1" file="2.fasta"/>
        </test>
    </tests>
    <help><![CDATA[
    Create help section here 
    ]]></help>
</tool>